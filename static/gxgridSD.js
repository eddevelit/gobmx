gx.grid={drawAtServer:!1,deleteMethods:{images:0,menu:1,none:2},deletePositions:{left:0,right:1,bottomR:2,bottomL:3,topR:4,topL:5},deleteMethod:null,deleteImage:null,undeleteImage:null,deletePosition:null,deletePositionFree:null,deleteTooltip:null,deleteTitle:null,lastFocusCtrl:null,styles:{none:0,uniform:1,header:2,report:3},getImplClass:function(m,n){if(n){gx.lang.inherits(gx.ui.grid,gx.uc.UserControl,!0);gx.lang.inherits(gx.ui.grid,gx.grid.impl,!0);gx.lang.inherits(n,gx.ui.grid,!0);var i=new n;
m&&(i.ParentObject=m.parentObject,i.ControlName=m.gridName,m.parentObject.setUserControl(i));return i}return new gx.grid.impl("gx")},validGridColsValue:function(m){var n=m,n=void 0!=m?m:1;return 0!=n?n:9999},grid:function(m,n,i,t,s,C,D,w,E,F,G,H,x,I,J,y,K,L,M,N,z,O,A,P,Q,R,B,S,T,U){this.parentObject=m;this.gridLvl=n;this.gridLvlName=i;this.gridId=t;this.gridName=s;this.realGridName=C;this.containerName=D||this.gridName+"Container";this.parentName=F||"";this.pagingParms=[];this.lvlKey=G||[];this.isFreestyle=
H||!1;this.allowHovering=(this.allowSelection=I||!1)&&J||!1;this.allowCollapsing=T||!1;this.collapsed=!1;this.sortable=!0;this.hoverColor=this.selectionColor=null;this.visible=!0;this.refreshTimer=null;this.pageSizeParm=P||!1;this.hasAddlines=Q||!1;this.hasForEachLine=R||!1;this.width=void 0!=z?z:0;this.widthUnit=O||"";this.gridCols=void 0!=x?x:1;this.gridCols=0!=this.gridCols?this.gridCols:9999;this.gridRows=void 0!=y?y:5;this.usePaging=(this.usePaging=K||!1)&&!this.isFreestyle;this.eof=1;this.firstRecordOnPage=
0;this.defaultDragable=L||!1;this.defaultSetsContext=M||!1;this.boundedCollType=N||"";this.boundedCollName=U||"";this.gxContainerCtrl=this.contextMenu=null;this.lastRefreshParms="";this.gxComponentContext=w;this.isMasterPageGrid=E;this.htmlTags="";this.onLineActivate=S;this.addingRows=!1;this.deleteMethod=gx.grid.deleteMethod;this.DatePickersControls=[];this.GridUserControls=[];this.GridComponents=[];this.GridControls=[];this.implClass=B;this.grid=gx.grid.getImplClass(this,B);this.grid.ownerGrid=
this;this.grid.parentGxObject=this.parentObject;this.grid.gxLvl=this.gridLvl;this.grid.gxId=this.gridId;this.grid.gxGridName=this.gridName;this.grid.gxGridObject=this.containerName;this.grid.gxParentName=this.parentName;this.grid.gxIsFreestyle=this.isFreestyle;this.grid.gxWidth=this.width;this.grid.gxWidthUnit=this.widthUnit;this.grid.gxHeight=0;this.grid.gxAllowSelection=this.allowSelection;this.grid.gxAllowHovering=this.allowHovering;this.grid.gxAllowCollapsing=this.allowCollapsing;this.grid.gxCollapsed=
this.collapsed;this.grid.gxSortable=this.sortable;this.grid.gxSelectionColor=this.selectionColor;this.grid.gxHoverColor=this.hoverColor;this.grid.gxVisible=this.visible;this.grid.gxGridCols=this.gridCols;this.grid.gxCmpContext=this.gxComponentContext;this.grid.gxHtmlTags=this.htmlTags;this.grid.gxIsMasterPageGrid=this.isMasterPageGrid;this.grid.gxDragable=this.defaultDragable;this.grid.gxHasAddlines=this.hasAddlines;this.grid.gxHasForEachLine=this.hasForEachLine;this.grid.gxOnLineActivate=this.onLineActivate;
this.grid.gxNewRowText=void 0!=A?A:"New Row";this.currentBuffer=this.grid.gxBuffer;this.parentGrid=null;this.childGrids=[];this.hiddens=[];this.oldCmps={};this.ColumnPropertiesAfterRender=[];this.isUsercontrol=gx.lang.instanceOf(this.grid,gx.uc.UserControl);this.gxCreateGridCode=function(a){return new gx.grid.grid(this.parentObject,this.gridLvl,this.gridLvlName,this.gridId,this.gridName+"_"+a,this.gridName,this.containerName+"_"+a,this.gxComponentContext,this.isMasterPageGrid,this.parentName,this.lvlKey,
this.isFreestyle,this.gridCols,this.allowSelection,this.allowHovering,this.gridRows,this.usePaging,this.defaulDragable,this.defaulSetsContext,this.boundedCollType,this.width,this.widthUnit,this.grid.gxNewRowText,this.pageSizeParm,this.hasAddlines,this.hasForEachLine,this.implClass,this.onLineActivate,this.allowCollapsing)}.closure(this);this.gxAddColumnsCode=[];this.grid.usePaging=this.usePaging;this.grid.eof=this.eof;this.grid.firstRecordOnPage=this.firstRecordOnPage;this.postingVariables=[];this.addColumnDinCode=
function(a,b){this.gxAddColumnsCode.push(function(){a.apply(this,b)})};this.addSingleLineEdit=function(a,b,c,d,e,f,h,k,j,u,g,i,o,l,p,m,n,r,s,t){this.addColumnDinCode(this.addSingleLineEdit,arguments);var q=this.newColumn(d,h,i,k);q.visible=n;q.htmlName=c;q.gxId=b;q.gxAttId=a;q.gxAttName=f;q.gxTooltip=e;q.gxWidthUnit=j;q.gxColSize=g;q.gxSetsContext=s;q.gxControl=new gx.html.controls.singleLineEdit;q.gxControl.column=q;q.gxControl.isPassword=t;q.gxControl.visible=q.visible;q.gxControl.dataType=q.type;
q.gxControl.clickEvent=o;this.grid.addColumn(q)};this.addPostingVar=function(a){this.postingVariables.push(a)};this.addMultipleLineEdit=function(a,b,c,d,e,f,h,k,j,u,g,i,o,l,p,m,n){this.addColumnDinCode(this.addMultipleLineEdit,arguments);var r=this.newColumn(d,f,o,h);r.visible=p;r.htmlName=c;r.gxId=b;r.gxAttId=a;r.gxAttName=e;r.gxWidthUnit=k;r.gxSetsContext=m;r.gxControl=new gx.html.controls.multipleLineEdit;r.gxControl.column=r;r.gxControl.dataType=r.type;r.gxControl.visible=r.visible;r.gxControl.heightUnit=
u;r.gxControl.clickEvent=l;this.grid.addColumn(r)};this.addBlob=function(a,b,c,d,e,f,h,k,j,u,g,i,o){this.addColumnDinCode(this.addBlob,arguments);var l=this.newColumn(d,f,"left",j);l.visible=i;l.htmlName=c;l.gxId=b;l.gxAttId=a;l.gxAttName=e;l.gxWidthUnit=g;l.gxSetsContext=o;l.gxControl=new gx.html.controls.blob;l.gxControl.column=l;l.gxControl.dataType=l.type;l.gxControl.visible=l.visible;l.gxControl.height=k;l.gxControl.width=j;this.grid.addColumn(l)};this.addRadioButton=function(a,b,c,d,e,f,h,k,
j,i){this.addColumnDinCode(this.addRadioButton,arguments);var g=this.newColumn(d,f,"left","");g.visible=j;g.htmlName=c;g.gxId=b;g.gxAttId=a;g.gxAttName=e;g.gxSetsContext=i;g.gxControl=new gx.html.controls.radio;g.gxControl.column=g;g.gxControl.dataType=g.type;g.gxControl.vertical=k;g.gxControl.visible=g.visible;g.gxControl.clickEvent=h;this.grid.addColumn(g)};this.addComboBox=function(a,b,c,d,e,f,h,k,j,i,g,m){this.addColumnDinCode(this.addComboBox,arguments);var o=this.newColumn(d,f,"left",g);o.visible=
j;o.htmlName=c;o.gxId=b;o.gxAttId=a;o.gxAttName=e;o.gxSetsContext=i;o.gxWidthUnit=m;o.gxControl=new gx.html.controls.comboBox;o.gxControl.column=o;o.gxControl.dataType=o.type;o.gxControl.rtEnabled=1==k;o.gxControl.visible=o.visible;o.gxControl.clickEvent=h;this.grid.addColumn(o)};this.addListBox=function(a,b,c,d,e,f,h,k,j,i,g,m,o){this.addColumnDinCode(this.addListBox,arguments);var l=this.newColumn(d,f,"left",g);l.visible=j;l.htmlName=c;l.gxId=b;l.gxAttId=a;l.gxAttName=e;l.gxSetsContext=i;l.gxWidthUnit=
m;l.gxControl=new gx.html.controls.listBox;l.gxControl.column=l;l.gxControl.dataType=l.type;l.gxControl.rows="undefined"!=typeof o?o:4;l.gxControl.rtEnabled=1==k;l.gxControl.visible=l.visible;l.gxControl.clickEvent=h;this.grid.addColumn(l)};this.addCheckBox=function(a,b,c,d,e,f,h,k,j,i,g,m,o,l){this.addColumnDinCode(this.addCheckBox,arguments);var p=this.newColumn(d,h,"left",o);p.visible=g;p.htmlName=c;p.gxId=b;p.gxAttId=a;p.gxAttName=f;p.gxChecked=k;p.gxUnChecked=j;p.gxSetsContext=m;p.gxWidthUnit=
l;p.gxControl=new gx.html.controls.checkBox;p.gxControl.column=p;p.gxControl.checkedValue=k;p.gxControl.uncheckedValue=j;p.gxControl.dataType=p.type;p.gxControl.visible=p.visible;p.gxControl.clickEvent=i;this.grid.addColumn(p)};this.addBitmap=function(a,b,c,d,e,f,h,k,j,i){this.addColumnDinCode(this.addBitmap,arguments);var g=this.newColumn(i,"","left",d);g.htmlName=b;g.gxId=c;g.gxAttId=a;g.gxWidthUnit=e;g.gxControl=new gx.html.controls.image;g.gxControl.column=g;g.gxControl.dataType=g.type;g.gxControl.width=
d;g.gxControl.widthUnit=e;g.gxControl.height=f;g.gxControl.heightUnit=h;g.gxControl.clickEvent=k;this.grid.addColumn(g)};this.addVideo=function(a,b,c,d,e,f,h,k,j,i){this.addColumnDinCode(this.addVideo,arguments);var g=this.newColumn(i,"","left",d);g.htmlName=b;g.gxId=c;g.gxAttId=a;g.gxWidthUnit=e;g.gxControl=new gx.html.controls.video;g.gxControl.column=g;g.gxControl.dataType=g.type;g.gxControl.width=d;g.gxControl.widthUnit=e;g.gxControl.height=f;g.gxControl.heightUnit=h;g.gxControl.clickEvent=k;
this.grid.addColumn(g)};this.addAudio=function(a,b,c,d,e,f,h,k,j,i){this.addColumnDinCode(this.addAudio,arguments);var g=this.newColumn(i,"","left",d);g.htmlName=b;g.gxId=c;g.gxAttId=a;g.gxWidthUnit=e;g.gxControl=new gx.html.controls.audio;g.gxControl.column=g;g.gxControl.dataType=g.type;g.gxControl.width=d;g.gxControl.widthUnit=e;g.gxControl.height=f;g.gxControl.heightUnit=h;g.gxControl.clickEvent=k;this.grid.addColumn(g)};this.addTextBlock=function(a,b){this.addColumnDinCode(this.addTextBlock,arguments);
var c=this.newColumn("","","left");c.htmlName=a;c.gxControl=new gx.html.controls.textBlock;c.gxControl.column=c;c.gxControl.dataType=c.type;c.gxControl.clickEvent=b;this.grid.addColumn(c)};this.addButton=function(a,b,c,d,e){this.addColumnDinCode(this.addButton,arguments);var f=this.newColumn("","","left");f.htmlName=b;f.gxId=a;f.gxControl=new gx.html.controls.button;f.gxControl.column=f;f.gxControl.dataType=f.type;this.grid.addColumn(f)};this.addGrid=function(a){this.addColumnDinCode(this.addGrid,
arguments);this.childGrids.push(a);var b=this.newColumn("","","left");b.gxControl=new gx.html.controls.grid;b.gxControl.column=b;this.grid.addColumn(b)};this.addUsercontrol=function(a,b,c,d,e,f,h,k){this.addColumnDinCode(this.addUsercontrol,arguments);var j=this.newColumn("","","left");j.gxUCId=a;j.gxUCLastId=b;j.gxUCClassName=c;j.gxUCContainerName=d;j.gxUCControlName=e;j.gxShowFunc=f;j.gxC2VFuncs=h;j.gxV2CFuncs=k;j.gxControl=new gx.html.controls.userControl;j.gxControl.column=j;j.gxControl.dataType=
j.type;this.grid.addColumn(j)};this.startContainer=function(){this.addColumnDinCode(this.startContainer,arguments);var a=this.newColumn("","","left");a.gxControl=new gx.html.controls.userControlContainer;a.gxControl.column=a;a.gxControl.dataType=a.type;this.grid.addColumn(a)};this.endContainer=function(){this.addColumnDinCode(this.endContainer,arguments);this.currentBuffer.append("</div>")};this.addWebComponent=function(a){this.addColumnDinCode(this.addWebComponent,arguments);var b=this.newColumn("",
"","left");b.gxControl=new gx.html.controls.webComponent;b.gxControl.column=b;b.gxControl.dataType=b.type;this.grid.addColumn(b)};this.addEmbeddedPage=function(a){this.addColumnDinCode(this.addEmbeddedPage,arguments);var b=this.newColumn("","","left");b.gxControl=new gx.html.controls.embeddedPage;b.gxControl.column=b;b.gxControl.dataType=b.type;this.grid.addColumn(b)};this.addHtmlCode=function(a){this.addColumnDinCode(this.addHtmlCode,arguments);this.currentBuffer.append(a)};this.startTable=function(a,
b,c){this.addColumnDinCode(this.startTable,arguments);var d=this.newColumn("","","left");d.htmlName=a+"_"+b;d.gxControl=new gx.html.controls.table;d.gxControl.column=d;d.gxControl.width=c;d.gxControl.dataType=d.type;this.grid.addColumn(d)};this.endTable=function(){this.addColumnDinCode(this.endTable,arguments);this.currentBuffer.append("</table>")};this.startRow=function(a,b,c,d,e,f){this.addColumnDinCode(this.startRow,arguments);var h=this.newColumn("","","left");h.gxControl=new gx.html.controls.row;
h.gxControl.column=h;h.gxControl.title=a;h.gxControl.align=b;h.gxControl.verticalAlign=c;h.gxControl.backColor=d;h.gxControl.borderColor=e;h.gxControl.cssClass=f;h.gxControl.ownCssClass=f;h.gxControl.dataType=h.type;this.grid.addColumn(h)};this.endRow=function(){this.addColumnDinCode(this.endRow,arguments);this.currentBuffer.append("</tr>")};this.startCell=function(a,b,c,d,e,f,h,k,j,i){this.addColumnDinCode(this.startCell,arguments);var g=this.newColumn("","","left");g.gxControl=new gx.html.controls.cell;
g.gxControl.column=g;g.gxControl.title=a;g.gxControl.align=b;g.gxControl.verticalAlign=c;g.gxControl.backColor=d;g.gxControl.borderColor=e;g.gxControl.height=f;g.gxControl.width=h;g.gxControl.colSpan=k;g.gxControl.rowSpan=j;g.gxControl.cssClass=i;g.gxControl.dataType=g.type;this.grid.addColumn(g)};this.endCell=function(){this.addColumnDinCode(this.endCell,arguments);this.currentBuffer.append("</td>")};this.startGroup=function(a,b,c,d){this.addColumnDinCode(this.startGroup,arguments);var e=this.newColumn("",
"","left");e.htmlName=a;e.gxControl=new gx.html.controls.group;e.gxControl.column=e;e.gxControl.id=a;e.gxControl.caption=b;e.gxControl.height=c;e.gxControl.width=d;e.gxControl.dataType=e.type;this.grid.addColumn(e)};this.endGroup=function(){this.addColumnDinCode(this.endGroup,arguments);this.currentBuffer.append("</fieldset>")};this.startDiv=function(a,b,c,d){this.addColumnDinCode(this.startDiv,arguments);var e=this.newColumn("","","left");e.htmlName=a+"_"+b;e.gxControl=new gx.html.controls.div;e.gxControl.column=
e;e.gxControl.width=d;e.gxControl.height=c;e.gxControl.dataType=e.type;this.grid.addColumn(e)};this.endDiv=function(){this.addColumnDinCode(this.endDiv,arguments);this.currentBuffer.append("</div>")};this.newColumn=function(a,b,c,d){b=this.getColumnType(b);a=new gx.grid.column(a,b,d,c);this.currentBuffer=a.buffer;a.htmlName="";a.gxId="";a.gxAttId="";a.gxAttName="";return a};this.getColumnType=function(a){switch(a){case "decimal":case "int":a=gx.types.numeric;break;case "date":a=gx.types.date;break;
case "dtime":a=gx.types.dateTime;break;case "boolean":a=gx.types.bool;break;case "Geolocation":a=gx.types.geolocation;break;default:a=gx.types.character}return a};this.addOldComponent=function(a,b){"undefined"==typeof this.oldCmps[a]&&(this.oldCmps[a]=[]);this.oldCmps[a].push(b)};this.updateOldComponents=function(){for(var a=this.grid.rows.length,b=0;b<a;b++)delete this.oldCmps[this.grid.rows[b].gxId];for(var c in this.oldCmps){for(a=this.oldCmps[c];0<a.length;)b=a.shift(),gx.fn.deleteHidden(b);delete this.oldCmps[c]}};
this.addHidden=function(a){this.hiddens.push(a)};this.addHiddenControl=function(a,b,c){gx.fn.setHidden(a,b);!0!=c&&this.addHidden(a)};this.clearHiddens=function(){for(;0<this.hiddens.length;){var a=this.hiddens.shift();gx.fn.deleteHidden(a)}};this.setHtmlTags=function(a){var b,c;c=' style="'+("0"==a.Visible?"display:none;":"");b=""+(' class="'+a.Class+'"');var d=gx.lang.emptyObject;c+=!d(a.Background)?"background:"+a.Background+";":"";c+=!d(a.Backcolor)&&"0"!=a.Backcolor?"background-color:"+gx.color.html(a.Backcolor).Html+
";":"";c+=!d(a.Bordercolor)&&"0"!=a.Bordercolor?"border-color:"+gx.color.html(a.Bordercolor).Html+";":"";b+=!d(a.Align)?' align="'+a.Align+'"':"";b+=!d(a.Tooltiptext)?' title="'+a.Tooltiptext+'"':"";c+=!d(a.Borderwidth)&&"0"!=a.Borderwidth?" border-width:"+a.Borderwidth+";":"";b+=!d(a.Cellpadding)?' cellpadding="'+a.Cellpadding+'"':"";b+=!d(a.Cellspacing)?' cellspacing="'+a.Cellspacing+'"':"";b+=!d(a.Height)&&"0"!=a.Height?' height="'+a.Height+'"':"";b+=!d(a.Width)&&"0"!=a.Width?' width="'+a.Width+
'"':"";this.htmlTags=gx.text.trim(b+(c+'"'));this.grid.gxHtmlTags=this.htmlTags;d(a.Width)||(this.grid.gxWidth=a.Width);d(a.Height)||(this.grid.gxHeight=a.Height)};this.setGridStyles=function(a){this.visible=void 0!=a.Visible?gx.lang.gxBoolean(a.Visible):!0;this.setSortable(void 0!=a.Sortable?gx.lang.gxBoolean(a.Sortable):!0);this.background=void 0!=a.Background?a.Background:"";this.cssClass=void 0!=a.Class?a.Class:"";this.titleBackstyle=void 0!=a.Backcolorstyle?a.Backcolorstyle:gx.grid.styles.none;
this.titleFont=void 0!=a.Titlefont?a.Titlefont:"";this.linesFont=void 0!=a.Linesfont?a.Linesfont:"";this.borderWidth=void 0!=a.Borderwidth?a.Borderwidth:"";this.toolTipText=void 0!=a.Tooltiptext?a.Tooltiptext:"";try{this.backcolor=void 0!=a.Backcolor?gx.color.html(a.Backcolor).Html:"",this.titleBackcolor=void 0!=a.Titlebackcolor?gx.color.html(a.Titlebackcolor).Html:"",this.titleForecolor=void 0!=a.Titleforecolor?gx.color.html(a.Titleforecolor).Html:"",this.linesBackcolorOdd=void 0!=a.Backcolorodd?
gx.color.html(a.Backcolorodd).Html:"",this.linesBackcolorEven=void 0!=a.Backcoloreven?gx.color.html(a.Backcoloreven).Html:"",this.bordercolor=void 0!=a.Bordercolor?gx.color.html(a.Bordercolor).Html:""}catch(b){gx.dbg.logEx(b,"gxgrid.js","setGridStyles")}this.borderWidth=void 0!=a.Borderwidth?a.Borderwidth:"";this.toolTipText=void 0!=a.Tooltiptext?a.Tooltiptext:"";this.grid.gxCssClass="";this.grid.gxTitleClass="";this.grid.gxFooterClass="";this.grid.gxOddLlinesClass="";this.grid.gxEvenLinesClass="";
this.grid.gxBackColor=this.backcolor;this.grid.gxTitleBackColor=this.titleBackcolor;this.grid.gxTitleForeColor=this.titleForecolor;this.grid.gxTitleBackstyle=this.titleBackstyle;this.grid.gxTitleFont=this.titleFont;this.grid.gxLinesFont=this.linesFont;this.grid.gxBackground=this.background;this.grid.gxLinesBackcolorOdd=this.linesBackcolorOdd;this.grid.gxLinesBackcolorEven=this.linesBackcolorEven;this.grid.gxBorderWidth=this.borderWidth;this.grid.gxBordercolor=this.bordercolor;this.grid.gxToolTipText=
this.toolTipText;this.grid.gxVisible=this.visible;""!=this.cssClass&&(this.grid.gxCssClass=this.cssClass,this.grid.gxTitleClass=this.cssClass+"Title",this.grid.gxFooterClass=this.cssClass+"Footer",this.titleBackstyle==gx.grid.styles.none?(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):this.titleBackstyle==gx.grid.styles.uniform?(this.grid.gxOddLlinesClass=this.cssClass+"Uniform",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):this.titleBackstyle==
gx.grid.styles.header?(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):this.titleBackstyle==gx.grid.styles.report&&(this.isFreestyle&&0>=this.gridCols?(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.grid.gxOddLlinesClass):(this.grid.gxOddLlinesClass=this.cssClass+"Odd",this.grid.gxEvenLinesClass=this.cssClass+"Even")))};this.setSortable=function(a){if(this.sortable!=a){this.sortable=a;for(var b=this.grid.columns.length,
c=0;c<b;c++)this.grid.columns[c].sortable=a}};this.lastRowId=0;this.addRow=function(a){var b,c,d,e=this.lastRowId++,f=gx.grid.rowId(e+1),f=new gx.grid.row(e,a,f,this.grid.gxParentRowId);f.gxCmpContext=this.gxComponentContext;f.Grids=a.Grids;f.ownerGrid=this;f.gxLvl=this.gridLvl;this.setRowHiddens(a.Hiddens);var h=this.grid.columns,k;k=h.length;for(var j=0;j<k;j++){var i=h[j];if(0!==e){d=this.grid.rows[0].gxProps[j];b=a.Props[j].length;for(c=this.grid.rowsValues?d.length-1:d.length;b<c;b++)f.gxProps[j].push(d[b])}d=
a.Props[j];c=d[d.length-1];this.grid.rowsValues&&!this.autoRefreshing?void 0!==this.grid.rowsValues[e]&&(c=this.grid.rowsValues[e][j]):c=d[d.length-1];f.values[j]=c;this.grid.rowsValues&&f.gxProps[j].push(c);this.parentObject.isTransaction()&&(i=this.columnIndexInKey(i.gxAttId),-1!=i&&(f.gxKeyValues[i]=c))}this.isFreestyle&&(f.IsNew=!0,this.installChildGrids(f));this.grid.addRow(f);return f};this.installChildGrids=function(a){for(var b=this.childGrids.length,c=0;c<b;c++){var d=this.childGrids[c],
e=d.gxCreateGridCode(a.gxId);e.grid.parentGxObject=this.parentObject;var f=(!e.isMasterPageGrid?this.grid.gxCmpContext:"MP")+e.realGridName+"Container";e.gxContainerDivName=f+"Div_"+a.gxId;e.gxContainerDataName=f+"Data_"+a.gxId;e.gxContainerValuesName=f+"DataV_"+a.gxId;a.gxGrids.push(e);e.parentGrid=this;e.parentRow=a;this.parentObject.setGrid(e);d.copyPropertiesTo(e);e.grid.gxCmpContext=this.grid.gxCmpContext;e.grid.gxParentRowId=a.gxId;this.installChildGridColumns(e,d)}};this.installChildGridColumns=
function(a,b){for(var c=b.gxAddColumnsCode.length,d=0;d<c;d++)b.gxAddColumnsCode[d].call(a)};this.copyPropertiesTo=function(a){a.cssClass=this.cssClass;a.titleBackstyle=this.titleBackstyle;a.titleBackcolor=this.titleBackcolor;a.linesBackcolorOdd=this.linesBackcolorOdd;a.linesBackcolorEven=this.linesBackcolorEven;a.grid.gxCssClass=this.grid.gxCssClass;a.grid.gxTitleClass=this.grid.gxTitleClass;a.grid.gxOddLlinesClass=this.grid.gxOddLlinesClass;a.grid.gxEvenLinesClass=this.grid.gxEvenLinesClass;a.grid.gxAllowCollapsing=
this.grid.gxAllowCollapsing;a.grid.gxCollapsed=this.grid.gxCollapsed};this.setRowHiddens=function(a){if(a&&this.parentObject.isTransaction())for(var b in a)gx.fn.setHidden(b,a[b])};this.executeEvent=function(a,b){gx.evt.setGridEvt(this.gridId.toString(),b);this.instanciateRow(b);this.parentObject[a].call(this.parentObject,b)};this.updatePagingVars=function(a,b){this.grid.usePaging&&(void 0==a&&void 0==b?(this.grid.eof=gx.fn.getHidden(this.grid.gxCmpContext+this.grid.gxGridName.toUpperCase()+"_nEOF"),
this.grid.firstRecordOnPage=gx.fn.getHidden(this.grid.gxCmpContext+this.grid.gxGridName.toUpperCase()+"_nFirstRecordOnPage")):(this.grid.eof=a,this.grid.firstRecordOnPage=b))};this.setPagingVars=function(a,b){this.grid.eof=a;this.grid.firstRecordOnPage=b;var c=this.grid.gxGridName.toUpperCase(),d=this.grid.gxCmpContext;gx.fn.setHidden(d+c+"_nEOF",a);gx.fn.setHidden(d+c+"_nFirstRecordOnPage",b)};this.clearDefaultEventHandlers=function(){var a=0;if(this.defaultDragable||this.defaultSetsContext)for(var a=
this.grid.rows.length,b=0;b<a;b++){var c=this.containerName+"Row_"+this.grid.rows[b].gxId;this.defaultDragable&&gx.fx.dnd.deleteSource(c);this.defaultSetsContext&&gx.fx.ctx.deleteSetter(c)}a=this.grid.columns.length;for(b=0;b<a;b++)if(c=this.grid.columns[b],!0==c.gxSetsContext)for(var d=this.grid.rows.length,e=0;e<d;e++)gx.fx.ctx.deleteSetter(c.htmlName+"_"+this.grid.rows[e].gxId)};this.setDefaultEventHandlers=function(){var a=0;if(this.defaultDragable||this.defaultSetsContext)if(gx.lang.emptyObject(this.boundedCollType))for(var b=
this.getRowAsTypes(),a=this.grid.rows.length,c=0;c<a;c++){var d=this.gxComponentContext+this.containerName+"Row_"+this.grid.rows[c].gxId,e=gx.dom.el(d);null!=e&&(e.gxGrid=this.containerName,e.gxGridName=this.gridName,e.gxId=this.grid.rows[c].gxId);d=this.containerName+"Row_"+this.grid.rows[c].gxId;e=function(a){return this.returnRowData(a)}.closure(this);this.defaultDragable&&gx.fx.dnd.addSource(this.parentObject,d,this.cssClass,b,e);this.defaultSetsContext&&gx.fx.ctx.addSetter(this.parentObject,
d,this.cssClass,b,e)}else a=this.grid.gxCmpContext+this.containerName+"Div",e=function(){return this.returnGridData()}.closure(this),this.defaultDragable&&gx.fx.dnd.addSource(this.parentObject,a,this.cssClass,[this.boundedCollType],e),this.defaultSetsContext&&gx.fx.ctx.addSetter(this.parentObject,a,this.cssClass,[this.boundedCollType],e);a=this.grid.columns.length;for(c=0;c<a;c++)if(b=this.grid.columns[c],!0==b.gxSetsContext){e=this.grid.rows.length;for(d=0;d<e;d++){var f=gx.dom.el(this.gxComponentContext+
b.htmlName+"_"+this.grid.rows[d].gxId);null!=f&&(f.gxHtmlName=b.htmlName,gx.fx.ctx.addSetter(this.parentObject,b.htmlName+"_"+this.grid.rows[d].gxId,"",[b.gxAttName],this.returnColumnContext))}}};this.returnColumnContext=function(a){var b="",b="SPAN"==a.nodeName?gx.dom.spanValue(a):gx.fn.getControlValue_impl(a.id);return null!=b?b:""};this.returnRowData=function(a){var b={};if(a=this.grid.getRowByGxId(a.gxId))for(var c=this.grid.columns.length,d=0;d<c;d++){var e=this.grid.columns[d].gxAttName;""!=
e&&(b[e]=a.values[d])}return b};this.returnGridData=function(){for(var a=[],b=this.grid.rows.length,c=0;c<b;c++){var d={};a[c]=d;for(var e=this.grid.rows[c],f=this.grid.columns.length,h=0;h<f;h++){var k=this.grid.columns[h].gxAttName;""!=k&&(d[k]=e.values[h])}}return a};this.doDrop=function(a){this.getNewRows(void 0!=a.length?ropObj.length:1,null,function(b){this.addDropedRows(b,a)})};this.addDropedRows=function(a,b){var c=b.length;if(void 0!=c)for(var d=0;d<c;d++)this.setDroppedRow(a[d],b[d]);else this.setDroppedRow(a[0],
b);this.setNewRows(a)};this.setDroppedRow=function(a,b){for(var c=this.grid.columns.length,d=0;d<c;d++){var e=a.Props[d],f=this.grid.columns[d].gxAttName,h="";""!=f&&void 0!=b[f]&&(h=b[f]);e.Value=h;e.FormattedValue=h}};this.getRowAsTypes=function(){for(var a=[],b=this.grid.columns.length,c=0;c<b;c++){var d=this.grid.columns[c].gxAttName;""!=d&&a.push(d)}return a};this.addRows=function(a){var b=a.Count;this.grid.rowsValues=a.values;for(var c=0;c<b;c++)this.addRow(a[c])};this.lastRowIsModified=function(){if(0==
this.grid.rows.length)return!1;var a=this.grid.rows[this.grid.rows.length-1];return a.gxExists()||a.gxIsMod()?!0:!1};this.getNewRows=function(a,b,c){var c=void 0!=c?c:this.setNewRows,d=gx.util.browser.isFirefox()?"keypress":"keydown";null==b||(b.type==d&&(32==b.charCode||32==b.keyCode||13==b.keyCode)||"click"==b.type)&&(0==this.grid.rows.length||this.lastRowIsModified())?(gx.csv.pkDirty=!1,gx.ajax.newRows(this.gxComponentContext,this.isMasterPageGrid,this.realGridName,a+this.lastRowId,this.lastRowId+
1,gx.grid.rowId(this.lastRowId+1)+this.grid.gxParentRowId,this.grid.gxParentRowId,c),gx.csv.pkDirty=!1,null!=b&&gx.evt.cancel(b,!0)):null!=b&&(32==b.keyCode||13==b.keyCode)&&gx.evt.cancel(b,!0)};this.setNewRows=function(a){if(void 0!=a.Count){for(var b=0,b=0;b<a.Count;b++){var c=this.addRow(a[b]);gx.fn.setCurrentGridRow(this.gridId,c.gxId)}0<a.Count&&(this.addingRows=!0,this.refreshGrid(!1),this.addingRows=!1,this.setFocusFirstControl(a[0]))}};this.gxNewRowFocused=function(a){a.style.textDecoration=
"underline";var b=gx.fn.firstGridControl(this.gridId);gx.evt.onfocus(a,b,this.gxComponentContext,this.isMasterPageGrid,"9999",this.gridId)};this.rowKeyPressed=function(a){var b=gx.evt.source(a);void 0!=b&&a.ctrlKey&&46==a.keyCode&&(this.setRowDeleted(b),gx.evt.cancel(a,!0))};this.gxHasDuplicateKey=function(){for(var a=[],b=this.grid.rows,c=b.length,d=0;d<c;d++){var e=b[d];if((e.gxExists()||e.gxIsMod())&&!e.gxDeleted()){for(var f="",h=e.gxKeyValues.length,k=0;k<h;k++)f+=e.gxKeyValues[k].toString();
if(void 0!=a[f])return!0;a[f]=1}}return!1};this.columnIndexInKey=function(a){for(var b=this.lvlKey.length,c=0;c<b;c++)if(this.lvlKey[c]==a)return c;return-1};this.refreshVars=[];this.addRefreshingVar=function(a){if(!gx.lang.emptyObject(a)){var b="";this.refreshVars[this.refreshVars.length]=a;if(a.fld){var c=gx.dom.el(this.gxComponentContext+a.fld);if(void 0!=c&&gx.lang.emptyObject(a.hc)&&("radio"==c.type||"checkbox"==c.type&&gx.util.browser.isIE()&&8>=gx.util.browser.ieVersion()?b="click":"SELECT"==
c.tagName||"checkbox"==c.type?b="change":gx.lang.isNumericType(a.type)?gx.lang.isNumericType(a.type)&&(b="blur"):b=["keyup","input"],""!=b))if("radio"==c.type)for(var a=gx.dom.byName(this.gxComponentContext+a.fld),c=a.length,d=0;d<c;d++)gx.evt.attach(a[d],b,function(){this.filterVarChanged()},this);else"search"==c.type&&(b=[b,"search"]),gx.evt.attach(c,b,function(){this.filterVarChanged()},this)}}};this.filterVarChanged=function(){if(this.parentObject.autoRefresh&&!gx.grid.drawAtServer){var a=this.getRefreshParmsUrl();
this.lastRefreshParms!=a&&(this.lastRefreshParms=a,this.callAsyncRefresh(a))}else this.parentObject.conditionsChanged=this.conditionsChanged()};this.conditionsChanged=function(){for(var a=this.refreshVars.length,b=0;b<a;b++){var c=this.refreshVars[b];if("undefined"==typeof c.rfrVar){var d=gx.fn.getHidden(this.gxComponentContext+"GXH_"+c.fld),c=c.val();if(d!=c)return!0}}return!1};this.getRefreshParmsUrl=function(){var a="";this.pageSizeParm&&(a=this.grid.pageSize+",");for(var b=this.refreshVars.length,
c=0;c<b;c++){var d=this.refreshVars[c];if("undefined"!=typeof d.rfrVar){var e=void 0,f=void 0;if("undefined"!=typeof d.rfrProp){var h;"undefined"!=typeof d.gxAttId&&(h=this.grid.getColumnByGxAttId(d.gxAttId));h||(h=this.grid.getColumnForVar(d.rfrVar));h?(d=d.rfrProp.toLowerCase(),e=h[d],"value"==d&&h.gxControl.type==gx.html.controls.types.image&&(e=gx.util.removeBaseUrl(e))):e=""}else"undefined"!=typeof this.parentObject.VarControlMap[d.rfrVar]&&(f=this.parentObject.VarControlMap[d.rfrVar].id),"undefined"!=
typeof f&&(e=gx.fn.getHidden(this.gxComponentContext+f)),"undefined"==typeof e&&(e=this.parentObject[d.rfrVar]),"object"==typeof e&&(e=gx.json.serializeJson(e));a+=encodeURIComponent(e)+","}else a=gx.lang.emptyObject(d.hc)?a+(this.getFormattedParm(d)+","):a+(encodeURIComponent(this.parentObject[d.hc])+","),gx.fn.setHidden(this.gxComponentContext+"GXH_"+d.fld,d.val())}this.parentObject.IsComponent&&(a+=encodeURIComponent(this.parentObject.CmpContext)+",");return a};this.initRefreshParms=function(){this.parentObject.autoRefresh&&
(this.lastRefreshParms=this.getRefreshParmsUrl())};this.getFormattedParm=function(a){return"date"==a.type?(a=gx.dom.el(this.gxComponentContext+a.fld),encodeURIComponent(gx.date.urlDate(a,gx.dateFormat))):"dtime"==a.type?(a=gx.dom.el(this.gxComponentContext+a.fld),encodeURIComponent(gx.date.urlDateTime(a,gx.dateFormat))):encodeURIComponent(a.val())};this.callAsyncRefresh=function(a){null!=this.refreshTimer&&(window.clearTimeout(this.refreshTimer),this.refreshTimer=null,gx.evt.setReady(!0));gx.evt.setReady(!1);
this.refreshTimer=window.setTimeout(function(){gx.ajax.refreshGrid(this,a);gx.evt.setReady(!0)}.closure(this),400)};this.updatePropsHidden=function(a){var b=this.getDataHiddenName();gx.fn.setHidden(b,a)};this.updatePagingVarsAfterRefresh=function(a){if(this.usePaging){var b=this.grid.gxGridName.toUpperCase()+"_nEOF",c=this.grid.gxGridName.toUpperCase()+"_nFirstRecordOnPage";this.setPagingVars(a[b],a[c])}};this.getSelection=function(){if(this.allowSelection)for(var a=this.grid.rows.length,b=0;b<a;b++)if(this.grid.rows[b].selected)return b;
return-1};this.setSelection=function(a){if(this.allowSelection&&0<=a){var a=gx.grid.rowId(a+1),b=gx.dom.el(this.grid.gxCmpContext+this.grid.gxGridObject+"Row_"+a);b&&this.grid.setRowSelected(b,a)}};this.blankGridRows=function(){this.lastRowId=0;this.grid.rows=[];delete this.grid.rowsValues};this.setRowDeleted=function(a){var b=null,b="string"==typeof a?this.grid.getRowByGxId(a):void 0==a.gxId?this.getRowFromHtmlCtrl(a):a;b.setDeleted(!b.gxDeleted());this.setRowModified(b.gxId);gx.fn.removeGridRow(b.gxId,
this.gridId.toString());this.refreshGrid()};this.setFocusFirstControl=function(a){for(var b=0;b<a.Count;b++){var c=this.grid.getRowByGxId(gx.grid.rowId(this.lastRowId)+this.grid.gxParentRowId);if(c&&(c=gx.dom.el(this.grid.gxCmpContext+this.grid.columns[b].htmlName+"_"+c.gxId),void 0!=c&&gx.fn.isAccepted(c))){gx.grid.lastFocusCtrl=this.grid.columns[b].gxId;gx.fn.setFocus(c);break}}};this.instanciateRow=function(a){var b=gx.O;gx.setGxO(this.parentObject.CmpContext,this.parentObject.IsMasterPage);try{var c=
a;"string"==typeof c&&(c=this.grid.getRowByGxId(a));if(null!=c){gx.fn.setCurrentGridRow(this.gridId,c.gxId);for(var d=c.values.length,e=0;e<d;e++){var f=this.grid.columns[e];if(""!=f.gxId){var h=this.parentObject.getValidStruct(f.gxId);h&&(this.isUsercontrol?h.v2v&&(h.v2v(this.grid.properties[c.id][f.index].value),gx.fn.setHidden(this.grid.properties[c.id][f.index].id,this.grid.properties[c.id][f.index].value)):"function"==typeof h.c2v&&h.c2v())}}}else{gx.fn.setCurrentGridRow(this.gridId,a);d=this.grid.columns.length;
for(e=0;e<d;e++)f=this.grid.columns[e],""!=f.gxId&&(h=this.parentObject.getValidStruct(f.gxId))&&"function"==typeof h.c2v&&h.c2v()}}catch(k){gx.dbg.logEx(k,"gxgrid.js","instanciateRow")}gx.setGxO(b.CmpContext,b.IsMasterPage);return!0};this.setRenderProp=function(a,b,c,d){this.grid.setProp(a,b,c,d)};this.setRenderDynProp=function(a,b,c,d){this.grid.setDynProp(a,b,c,d)};this.addRenderEventHandler=function(a,b){this.grid.addEventHandler(a,b)};this.cleanup=function(){this.parentGrid=this.parentObject=
null;this.grid.ownerGrid=null;this.grid.parentGxObject=null;this.grid.container=null;this.grid.ascLabel=null;this.grid.descLabel=null;this.grid.columns=null;this.grid=this.grid.rows=null};this.loadGrid=function(a,b){gx.dbg.logPerf("loadGrid_"+this.gridName);var c=gx.O;gx.setGxO(this.parentObject.CmpContext,this.parentObject.IsMasterPage);this.isLoading=!0;var d=this.parentObject.isTransaction();d&&null==this.contextMenu&&(this.contextMenu=new gx.grid.contextMenu(this));void 0!=a?(d=this.getContainerControl(),
null!=d&&(!0==b&&(a.values=this.getValuesFromHidden(),this.isFreestyle&&gx.lang.emptyObject(this.parentRow)&&this.backupComponents()),this.deleteGridData(),this.grid.setContainerDelayed(d),this.clearHiddens(),this.setRowsProperty(),d=this.getSelection(),this.blankGridRows(),this.setHtmlTags(a),this.setGridStyles(a),this.setDeleteMethod(a.DeleteMethod),this.setSelectionAndHover(a.Allowselection,a.Selectioncolor,a.Allowhover,a.Hovercolor),this.setCollapsing(a.Allowcollapsing,a.Collapsed),this.setSflColumns(a.SflColumns),
this.setColumnsProperties(a.Columns),this.autoRefreshing?this.updatePagingVarsAfterRefresh(a):this.updatePagingVars(),this.addRows(a),this.updateOldComponents(),this.initRefreshParms(),this.refreshGrid(null,this.autoRefreshing),this.setSelection(d))):(this.clearHiddens(),this.setRowsProperty(),this.grid.pageSize=d||this.isFreestyle?9999:this.gridRows,d=this.getContainerControl(),null!=d?(this.grid.setContainerDelayed(d),d=this.getRowsFromHidden(),null!=d?(d.values=this.getValuesFromHidden(),this.blankGridRows(),
this.setHtmlTags(d),this.setGridStyles(d),this.setDeleteMethod(d.DeleteMethod),this.setSelectionAndHover(d.Allowselection,d.Selectioncolor,d.Allowhover,d.Hovercolor),this.setCollapsing(d.Allowcollapsing,d.Collapsed),this.setSflColumns(d.SflColumns),this.setColumnsProperties(d.Columns),this.updatePagingVars(),this.addRows(d),this.initRefreshParms(),this.addingRows=!0,this.refreshGrid(),this.addingRows=!1):(this.blankGridRows(),this.updatePagingVars(),this.initRefreshParms(),this.refreshGrid())):this.loadWrappedGridChilds());
this.isLoading=!1;gx.setGxO(c.CmpContext,c.IsMasterPage);gx.dbg.logPerf("loadGrid_"+this.gridName,"Grid '"+this.gridName+"' loaded")};this.loadWrappedGridChilds=function(){try{var a=gx.fn.getHidden(this.grid.gxCmpContext+"nRC_"+this.gridName);if("undefined"!=typeof a){for(var a=parseInt(a),b=0;b<a;b++)for(var c=this.grid.columns.length,d=0;d<c;d++){var e=this.grid.columns[d];e.gxControl.type==gx.html.controls.types.userControl&&this.addUsercontrolToDraw({r:gx.grid.rowId(b+1),c:e})}this.setupGridUsercontrols(this.GridUserControls)}}catch(f){gx.dbg.logEx(f,
"gxgrid.js","loadWrappedGridChilds")}};this.getRowsFromHidden=function(){var a=this.getDataHiddenName(),b=gx.fn.getHidden(a);if(gx.lang.emptyObject(b))return null;gx.json.setNonSerializable(a);return gx.json.evalJSON(b)};this.deleteGridData=function(){var a=this.getDataHiddenName();gx.json.setNonSerializable(a)};this.getValuesFromHidden=function(){var a=this.getValuesHiddenName(),b=gx.fn.getHidden(a);gx.lang.emptyObject(b)&&(b=gx.fn.getControlValue(a));gx.json.setNonSerializable(a);a=null;null!=b&&
""!=b&&(a=gx.json.evalJSON(b));return a};this.getContainerControl=function(){var a=null;if(a=void 0!=this.gxContainerDivName?gx.dom.byId(this.gxContainerDivName):gx.dom.byId(this.grid.gxCmpContext+this.containerName+"Div"))this.gxContainerCtrl=a,a.setAttribute("gxgridid",this.gridId.toString()),a.gxGridName=this.grid.gxGridName;return a};this.getDataHiddenName=function(){var a=""==this.grid.gxParentRowId?"":"_"+this.grid.gxParentRowId;return void 0!=this.gxContainerDataName?this.gxContainerDataName:
this.grid.gxCmpContext+this.containerName+"Data"+a};this.getValuesHiddenName=function(){var a=""==this.grid.gxParentRowId?"":"_"+this.grid.gxParentRowId;return void 0!=this.gxContainerValuesName?this.gxContainerValuesName:this.grid.gxCmpContext+this.containerName+"DataV"+a};this.setColumnsProperties=function(a){try{for(var b=a.length,c=0;c<b;c++){var d=this.grid.columns[c],e;for(e in a[c]){var f=a[c][e];e=this.fixColumnPropName(e);this.isUsercontrol&&(d[e]=f);d[e.toLowerCase()]=f}this.checkPromptColumn(d)}}catch(h){gx.dbg.logEx(h,
"gxgrid.js","setColumnsProperties")}};this.checkPromptColumn=function(a){try{if(this.isPromptColumn(a)){var b=gx.fn.getAttachedCtrl(a.htmlName);if(b&&b.info&&b.info.controls){for(var c=!1,d=!1,e=b.info.controls.length,f=0;f<e;f++){var h=this.grid.getColumnByGxId(b.info.controls[f]),k=gx.lang.gxBoolean(h.enabled),j=gx.lang.gxBoolean(h.visible);k&&(d=!0);j&&(c=!0)}d||(a.enabled="0");c||(a.visible="0")}}}catch(i){gx.dbg.logEx(i,"gxgrid.js","checkPromptColumn")}};this.fixColumnPropName=function(a){return"Horizontalalignment"==
a?"align":a};this.setDeleteMethod=function(a){if(this.parentObject.isTransaction()){var b="DSP"==this.parentObject.Gx_mode;!b&&a&&"none"==a&&(b=!0);this.deleteMethod=b?gx.grid.deleteMethods.none:gx.grid.deleteMethod}};this.setSelectionAndHover=function(a,b,c,d){try{this.allowSelection=gx.lang.gxBoolean(a),this.hoverColor=this.selectionColor=null,this.allowSelection&&(this.allowHovering=gx.lang.gxBoolean(c),b=eval(b),this.selectionColor="undefined"!=typeof b[0]?gx.color.fromRGB(b[0],b[1],b[2]):gx.color.html(b),
this.allowHovering&&(d=eval(d),this.hoverColor="undefined"!=typeof d[0]?gx.color.fromRGB(d[0],d[1],d[2]):gx.color.html(d))),this.grid.gxAllowSelection=this.allowSelection,this.grid.gxSelectionColor=this.selectionColor,this.grid.gxAllowHovering=this.allowHovering,this.grid.gxHoverColor=this.hoverColor}catch(e){gx.dbg.logEx(e,"gxgrid.js","setSelectionAndHover")}};this.setCollapsing=function(a,b){try{this.allowCollapsing=gx.lang.gxBoolean(a),this.collapsed=gx.lang.gxBoolean(b),this.grid.gxAllowCollapsing=
this.allowCollapsing,this.grid.gxCollapsed=this.collapsed}catch(c){gx.dbg.logEx(c,"gxgrid.js","setCollapsing")}};this.setSflColumns=function(a){try{if(!gx.lang.emptyObject(a)||0===a)this.gridCols=gx.grid.validGridColsValue(parseInt(a)),this.grid.gxGridCols=this.gridCols,1<this.gridCols&&0<this.gridRows&&(this.grid.pageSize=(this.gridRows?this.gridRows:1)*this.gridCols)}catch(b){gx.dbg.logEx(b,"gxgrid.js","setSflColumns")}};this.isPromptColumn=function(a){return a.gxAttId.indexOf&&-1!=a.gxAttId.indexOf("prompt_")?
!0:!1};this.setRowsProperty=function(){var a=gx.fn.getHidden(this.grid.gxCmpContext+this.gridName.toUpperCase()+"_Rows");if(null!=a){try{this.gridRows=parseInt(a,10)}catch(b){gx.dbg.logEx(b,"gxgrid.js","setRowsProperty")}this.grid.pageSize=this.gridRows*(1<this.gridCols?this.gridCols:1)}};this.crearInstalledSuggests=function(){for(var a=this.grid.columns.length,b=0;b<a;b++){var c=this.parentObject.getValidStruct(this.grid.columns[b].gxId);c&&c.gxsgprm&&c.gxsgprm.installed&&(c.gxsgprm.installed={})}};
this.refreshCollection=function(a){try{this.blankGridRows();this.updatePagingVars();this.initRefreshParms();for(var b=a.length,c=0;c<b;c++){for(var d={Props:[]},e=a[c],f=this.grid.columns.length,h=0;h<f;h++){var k=this.grid.columns[h];d.Props[k.index]=[e[k.gxAttName]]}this.addRow(d)}this.refreshGrid(!1,!1,!0)}catch(j){gx.dbg.logEx(j,"gxgrid.js","refreshCollection")}};this.refreshGrid=function(a,b,c){this.DatePickersControls=[];this.GridUserControls=[];this.GridComponents=[];this.GridControls=[];this.clearDefaultEventHandlers();
this.clearHiddens();this.crearInstalledSuggests();this.setRowsProperty();if(void 0!=this.parentRow&&!gx.lang.emptyObj(this.parentRow.Grids)){var d=this.parentRow.Grids[this.realGridName];null!=d&&(this.setHtmlTags(d),this.setGridStyles(d),this.setColumnsProperties(d.Columns),this.addingRows||this.parentRow.IsNew&&this.addRows(d))}var e=!1,d=function(){this.setupGridControls(this.GridControls);this.setupFixedColumnProperties();this.setupGridComponents(this.GridComponents);this.setupGridUsercontrols(this.GridUserControls);
this.triggerDatePickersSetup(this.DatePickersControls);this.installImageControls();this.isFreestyle&&this.loadRowsGrids(e);this.updateRcdCount();this.setDefaultEventHandlers()}.closure(this);this.grid.doSort();!1==a?this.grid.render(e,!1,c,d):(e=!0,this.grid.render(e,b,c,d))};var v="gx-wc-bkp_"+w+"_"+s;this.getComponentsBackupContainer=function(){var a=gx.dom.el(v);a||(a=document.createElement("div"),a.id=v,a.style.display="none",document.body.appendChild(a));return a};this.destroyComponentsBackup=
function(){var a=gx.dom.el(v);a&&a.parentNode&&gx.dom.removeControlSafe(a)};this.backupComponents=function(){try{for(var a=this.grid.rows.length,b=0;b<a;b++){for(var c=this.grid.rows[b],d=this.grid.columns.length,e=0;e<d;e++)if(this.grid.columns[e].gxControl.type==gx.html.controls.types.webComponent){var f=this.gxComponentContext+"gxHTMLWrp"+this.parentObject.getComponentPrefix(c.gxProps[e][0])+c.gxId,h=gx.dom.el(f);h&&(h.parentNode.removeChild(h),this.getComponentsBackupContainer().appendChild(h))}for(var k=
c.gxGrids.length,e=0;e<k;e++){var j=c.gxGrids[e];j&&j.isFreestyle&&j.backupComponents()}}}catch(i){gx.dbg.logEx(i,"gxgrid.js","backupComponents")}};this.getEntireGridColumn=function(a){var b=this.getContainerControl().firstChild,c=[];if(b.querySelectorAll)c=gx.fn.toArray(b.querySelectorAll("td[colindex='"+a+"'], th[colindex='"+a+"']"));else{for(var d=gx.dom.byTag("TD",b),b=gx.dom.byTag("TH",b),e=0,f=d.length;e<f;e++)d[e].getAttribute("colindex")==a&&c.push(d[e]);e=0;for(f=b.length;e<f;e++)b[e].getAttribute("colindex")==
a&&c.push(b[e])}return c};this.applyPropEntireColumn=function(a,b,c){for(var a=this.getEntireGridColumn(a),d=0;d<a.length;d++)gx.fn.setCtrlPropertyImpl(a[d],b,c)};this.setupFixedColumnProperties=function(){for(var a=0;a<this.ColumnPropertiesAfterRender.length;a++){var b=this.ColumnPropertiesAfterRender[a];this.applyPropEntireColumn(b.colIndex,b.ptyName,b.ptyValue)}};this.addColPropertyAfterRender=function(a,b,c){this.ColumnPropertiesAfterRender.push({colIndex:a,ptyName:b,ptyValue:c})};this.setupGridControls=
function(a){for(var b=0,c=a.length;b<c;b++){var d=a[b],e=gx.dom.el(d.hookId),f=e.parentNode;f&&(f.insertBefore(d.el,e),gx.dom.removeControlSafe(e))}};this.setupGridComponents=function(a){for(var b=a.length,c=0;c<b;c++){var d=a[c];if(!1===d.create){var e=gx.dom.el(d.existingEl),f=e.parentNode,d=gx.dom.el(d.el);gx.dom.removeControlSafe(e);f.appendChild(d)}else gx.html.processCode(d.c,!1,function(a){var b=gx.createComponent(a.n,a.p);if(b!=null){gx.addComponent(b);b.readServerVars();if(a.load)b.onload()}},
[d])}this.destroyComponentsBackup()};this.setupGridUsercontrols=function(a){for(var b=a.length,c=0;c<b;c++){var d=a[c].r,e=a[c].c,d=gx.uc.getNew(this.parentObject,e.gxUCId,e.gxUCLastId,e.gxUCClassName,e.gxUCContainerName+"_"+d,e.gxUCControlName,this.gridLvl,this.gridId,d);d.DesignContainerName=e.gxUCContainerName;d.setC2ShowFunction(e.gxShowFunc);for(var f=e.gxC2VFuncs.length,h=0;h<f;h++)d.addC2VFunction(e.gxC2VFuncs[h]);f=e.gxV2CFuncs.length;for(h=0;h<f;h++)d.addV2CFunction(e.gxV2CFuncs[h]);d.setGridProperties();
d.setGridEventHandlers();this.parentObject.setUserControl(d);d.execV2CFunctions(!0);d.execShowFunction()}};this.triggerDatePickersSetup=function(a){for(var b=a.length,c=0;c<b;c++){for(var d=a[c].CtrlId,e=a[c].Grid,f=a[c].Row,h=gx.O,k=null,j=gx.fn.controlIds(),i=j.length,g=0;g<i&&!(k=gx.fn.validStruct(j[g]),k.grid==e&&h.CmpContext+k.fld+"_"+f==d);g++);null!=k&&void 0!=k.dp&&gx.fn.installDatePicker(d,k.dp.f,k.dp.st,k.dp.wn,k.dp.mf,gx.fn.datePickerFormat(k.dp.pic,k.dp.dec,k.len))}};this.installImageControls=
function(){for(var a=gx.dom.byClass("gx-multimedia-upload","",this.gxContainerCtrl),b=0,c=a.length;b<c;b++)gx.html.multimediaUpload.createControl(a[b])};this.addComponentToDraw=function(a){this.GridComponents.push(a)};this.addUsercontrolToDraw=function(a){this.GridUserControls.push(a)};this.addDatepickerToSetup=function(a){this.DatePickersControls.push(a)};this.addControlToReuse=function(a){a.el.parentNode&&gx.dom.removeControlSafe(a.el);this.GridControls.push(a)};this.loadRowsGrids=function(a){for(var b=
this.grid.rows.length,c=0;c<b;c++)this.loadRowGrids(this.grid.rows[c],a)};this.loadRowGrids=function(a,b){for(var c=a.gxGrids.length,d=0;d<c;d++){var e=a.gxGrids[d];e.grid.setContainerDelayed(gx.dom.el(e.gxContainerDivName));if(b){if(void 0!=e.parentRow&&!gx.lang.emptyObj(e.parentRow.Grids)){var f=e.getDataHiddenName();gx.fn.setHidden(f,e.parentRow.Grids[e.realGridName])}e.loadGrid()}else e.refreshGrid();a.IsNew=!1}};this.updateRcdCount=function(){(this.hasForEachLine||this.parentObject.isTransaction())&&
gx.fn.setHidden(this.grid.gxCmpContext+"nRC_"+this.gridName,this.lastRowId.toString());var a=gx.fn.getHidden(this.grid.gxCmpContext+this.gridName.toUpperCase()+"_ROW");parseInt(a,10)>this.lastRowId&&this.grid.instanciateSelectionVars("0000")};this.updateControlValue=function(a,b){try{var c=this,d=gx.fn.currentGridRow(a.grid).toString(),e=d,f=d.length;if(4<f){var h=d.substring(4,f),c=gx.fn.gridObj(this.gxComponentContext,this.gridName+"_"+h,this.isMasterPageGrid);if(!c)return;e=d.substring(0,4)}var i=
parseInt(e,10)-1;!0==b&&c.setRowModified(d);var j=c.getColumnIndexByName(a.fld),m=gx.dom.el(this.gxComponentContext+a.fld+"_"+d);c.updateRowValue(j,i,m);return c}catch(g){gx.dbg.logEx(g,"gxgrid.js","updateControlValue")}return null};this.persistControlValue=function(a,b,c){var d=a.lastIndexOf("_");if(-1!=d){var e=a.substring(0,d);if(d=this.grid.getRowByGxId(a.substring(d+1)))if(e=this.grid.getColumnByHtmlName(e)){var f=this.parentObject[c.gxvar];"decimal"==c.type&&gx.lang.instanceOf(f,Number)&&(f=
f.toFixed(c.dec));d.values[e.index]=f;d.gxProps[e.index]||(d.gxProps[e.index]={});if((a=gx.dom.el(a))&&"SELECT"==a.tagName)d.gxProps[e.index].Values=gx.dom.comboBoxToObj(a);d.gxProps[e.index].Value=f;d.gxProps[e.index].FormattedValue=b}}};this.getColumnIndexByName=function(a){for(var b=this.grid.columns,c=b.length,d=0;d<c;d++)if(b[d].htmlName==a)return d;return-1};this.setRowModified=function(a){gx.fn.setHidden(this.grid.gxCmpContext+"nIsMod_"+this.gridLvl.toString()+"_"+a,1);null!=this.parentGrid&&
this.parentGrid.setRowModified(this.grid.gxParentRowId);this.grid.showDeleteImage(a)};this.validateRow=function(a){if(a)try{gx.fn.setCurrentGridRow(a.gxgridid,a.gxrow);var b=gx.fn.lastGridControl(a.gxgridid);gx.csv.validControls(gx.csv.lastId,b+1,!0)}catch(c){gx.dbg.logEx(c,"gxgrid.js","validateRow")}};this.updateRowValue=function(a,b,c){var b=this.grid.getRowById(b),d=this.grid.columns[a];"checkbox"==c.type&&(c.value=c.checked?d.gxChecked:d.gxUnChecked);var e=gx.fn.getControlValue(this.grid.columns[a].htmlName+
"_"+b.gxId),c=this.parentObject.getValidStruct(this.grid.columns[a].gxId).val();b.values[a]=c;gx.lang.emptyObject(b.gxProps[a])||(b.gxProps[a].Value=c,b.gxProps[a].FormattedValue=e);this.parentObject.isTransaction()&&(a=this.columnIndexInKey(d.gxAttId),-1!=a&&(b.gxKeyValues[a]=c));d.gxControl.type==gx.html.controls.types.blob&&gx.fn.setControlValue(this.grid.gxCmpContext+"gxBlob"+d.htmlName+"_"+b.gxId,c)};this.expandCollapse=function(a,b){gx.evt.cancel(b,!0);var c=gx.dom.el(this.gxComponentContext+
this.containerName+"Tbl");null!=c&&(this.collapsed?(c.style.display="block",a.src=gx.ajax.getImageUrl(gx,"collapseImage")):(c.style.display="none",a.src=gx.ajax.getImageUrl(gx,"expandImage")),this.collapsed=!this.collapsed,this.grid.gxCollapsed=this.collapsed,this.parentGrid?(c=this.gridName.substring(this.gridName.lastIndexOf("_")),c=this.gxComponentContext+this.realGridName.toUpperCase()+"_Collapsed"+c):c=this.gxComponentContext+this.realGridName.toUpperCase()+"_Collapsed",gx.fn.setHidden(c,this.collapsed?
"1":"0"))};this.getRowFromHtmlCtrl=function(a){var b=a.gxrow;gx.lang.emptyObject(b)&&(b=a.id.lastIndexOf("_"),b=a.id.substring(b+1));return this.grid.getRowByGxId(b)};this.showContextMenu=function(a,b){this.contextMenu.show(a,b)}},contextMenu:function(m){this.gxgrid=m;this.controlName=this.gxgrid.containerName+"ContextMenu";this.eventSource=this.contextEvent=this.rowClicked=null;var n=new gx.text.stringBuffer;this.show=function(i,m){this.gxgrid.validateRow(i);this.contextEvent=m;this.eventSource=
gx.evt.source(this.contextEvent);gx.evt.cancel(m,!0);this.rowClicked=i;this.startMenu();n.append('<div class="').append("menuItem").append('" id="').append("deleteRow").append('" align="center">').append(gx.getMessage("GXM_deleterow")).append("</div>");this.endMenu()};this.startMenu=function(){n.clear();var i=this.getMenuCoords();n.append('<div onclick="').append(this.gxgrid.grid.gridObject()+".contextMenu.contextMenuClicked(event);").append('" onmouseover="');n.append(this.gxgrid.grid.gridObject()+
".contextMenu.switchContextMenu();").append('" onmouseout="').append(this.gxgrid.grid.gridObject()+".contextMenu.switchContextMenu();").append('" oncontextmenu="gx.evt.cancel(event, true);');n.append('" style="').append("position:absolute;width:100;background-Color:menu; border: outset 1px gray;");n.append("top:"+i.top+"; left:"+i.left+";").append('">')};this.endMenu=function(){n.append("</div>");var i=gx.dom.byId(this.controlName);null==i&&(i=document.createElement("SPAN"),ContextControlShadow=document.createElement("SPAN"),
ContextControlShadow2=document.createElement("SPAN"),IFrameControl=document.createElement("IFRAME"),i.id=this.controlName,ContextControlShadow.id=this.controlName+"Shadow",ContextControlShadow2.id=this.controlName+"Shadow2",IFrameControl.id=this.controlName+"GXiFrameIEHack",IFrameControl.src="about:blank",IFrameControl.style.zIndex=1,IFrameControl.style.visibility="hidden",IFrameControl.style.position="absolute",IFrameControl.frameBorder="0",document.body.appendChild(i),document.body.appendChild(ContextControlShadow),
document.body.appendChild(ContextControlShadow2),document.body.appendChild(IFrameControl));gx.dom.shouldPurge()&&gx.dom.purge(i,!0);i.innerHTML=n.toString()};this.hide=function(){this.contextEvent=this.rowClicked=null;gx.dom.removeControl(gx.dom.byId(this.controlName))};this.getMenuCoords=function(){var i=0,m=0,n=this.contextEvent;if(n.pageX||n.pageY)i=n.pageX,m=n.pageY;else if(n.clientX||n.clientY)i=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,m=n.clientY+document.body.scrollTop+
document.documentElement.scrollTop;return{left:i,top:m}};this.contextMenuClicked=function(i){this.handleContextMenuAction(gx.evt.source(i).id);this.hide()};this.handleContextMenuAction=function(i){switch(i){case "deleteRow":this.gxgrid.setRowDeleted(this.rowClicked);break;case "undeleteRow":this.gxgrid.setRowDeleted(this.rowClicked)}};this.switchContextMenu=function(){}},rowId:function(m){for(m=m.toString();4>m.length;)m="0"+m;return m},_init:function(){this.deleteMethod||(this.deleteMethod=this.deleteMethods.images);
this.deleteImage=this.deleteImage&&this.deleteMethod==this.deleteMethods.images?gx.ajax.getImageUrl(this,"deleteImage"):gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"delete_16x.jpg",!0);this.undeleteImage=this.undeleteImage&&this.deleteMethod==this.deleteMethods.images?gx.ajax.getImageUrl(this,"undeleteImage"):this.deleteImage;this.deletePosition||(this.deletePosition=this.deletePositions.left);this.deletePositionFree||(this.deletePositionFree=this.deletePositions.topL);this.deleteTooltip=this.deleteTooltip?
gx.getMessage(this.deleteTooltip):"";this.deleteTitle=this.deleteTitle?gx.getMessage(this.deleteTitle):""},_deinit:function(){this.lastFocusCtrl=null}};
